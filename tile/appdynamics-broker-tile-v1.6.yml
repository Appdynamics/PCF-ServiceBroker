---
name: appdynamics-broker                                       # [1]
product_version: '1.1'                            # [1]
label: AppDynamics Service Broker
rank: 50
metadata_version: '1.5'                                    # [2]

icon_image: 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

serial: true
releases:                                                  # [5]
- name: appdynamics_broker
  version: '1.1'
  file: appdynamics_broker-1.1.tgz

# EDIT the stemcell version as required
stemcell_criteria:                                                  # [3]
  os: ubuntu-trusty
  version: '3146.9'
  requires_cpi: false

property_blueprints:
- name: encryption_key
  type: secret
- name: vm_credentials
  type: salted_credentials
  default:
    identity: vcap
- name: app_name
  type: string
  configurable: false
  default: AppDynamicsServiceBroker
- name: app_version
  type: string
  configurable: false
  default: v1
- name: app_uri
  type: string
  configurable: true
  default: appdynamics-service-broker
- name: machine_agent_app_name
  type: string
  configurable: true
- name: db_agent_app_name
  type: string
  configurable: false
  default: AppDynamicsDBAgent
- name: proxy_selector
  type: selector
  configurable: true
  default: Disable
  option_templates:
    - name: proxy_disabled_option
      select_value: Disable
      named_manifests:
        - name: proxy_snippet
          manifest: |
            proxy_enabled: false
      property_blueprints:
        - name: disabled
          type: boolean
          configurable: true
    - name: proxy_enabled_option
      select_value: Enable
      named_manifests:
        - name: proxy_snippet
          manifest: |
            proxy_enabled: true
            http_proxy_host: (( .properties.proxy_selector.proxy_enabled_option.http_proxy_host.value ))
            http_proxy_port: (( .properties.proxy_selector.proxy_enabled_option.http_proxy_port.value ))
            proxy_auth_enabled: (( .properties.proxy_selector.proxy_enabled_option.proxy_auth_enabled.value ))
            http_proxy_user: (( .properties.proxy_selector.proxy_enabled_option.http_proxy_user.value ))
            http_proxy_password: (( .properties.proxy_selector.proxy_enabled_option.http_proxy_password.value ))
      property_blueprints:
        - name: http_proxy_host
          type: string
          configurable: true
          default: _no_proxy_
        - name: http_proxy_port
          type: integer
          configurable: true
          default: 8080
        - name: proxy_auth_enabled
          type: boolean
          configurable: true
          default: false
        - name: http_proxy_user
          type: string
          configurable: true
          default: _none_
        - name: http_proxy_password
          type: secret
          configurable: true



- name: machine_agent_app_version
  type: string
  configurable: false
  default: v1
- name: db_agent_app_version
  type: string
  configurable: false
  default: v1
- name: machine_agent_app_uri
  type: string
  configurable: false
  default: appdynamics-pcf-ops-metrics
- name: db_agent_app_uri
  type: string
  configurable: false
  default: appdynamics-db-agent
- name: proxy_enabled
  type: boolean
  configurable: true
  default: false
- name: http_proxy_host
  type: string
  configurable: true
  default: _no_proxy_
- name: http_proxy_port
  type: integer
  configurable: true
  default: 8080
- name: proxy_auth_enabled
  type: boolean
  configurable: true
  default: false
- name: http_proxy_user
  type: string
  configurable: true
  default: _none_
- name: http_proxy_password
  type: secret
  configurable: true
  default:
- name: ops_metrics_host
  type: string
  configurable: true
- name: ops_metrics_port
  type: integer
  configurable: true
- name: ops_metrics_authenticate
  type: boolean
  configurable: true
  default: true
- name: ops_metrics_jmx_user
  type: string
  configurable: true
- name: ops_metrics_jmx_password
  type: secret
  configurable: true
- name: account_name
  type: string
  configurable: true
- name: account_access_key
  type: string
  configurable: true
- name: controller_host
  type: string
  configurable: true
- name: controller_port
  type: integer
  configurable: true
- name: tier_name
  type: string
  configurable: true
  default: 'MachineAgentTier'
- name: node_name
  type: string
  configurable: true
  default: 'MachineAgentNode'
- name: ssl_enabled
  type: boolean
  configurable: true
  default: true
- name: internal_service_names
  type: string
  configurable: false
  default: "appdynamics"
- name: create_open_security_group
  type: boolean
  configurable: false
  default: true
- name: enable_global_access_to_plans
  type: boolean
  configurable: true
  default: false
- name: org_quota
  type: integer
  configurable: false
  constraints:
    min: 512
    max: 1024
  default: 1024
- name: memory
  type: integer
  configurable: false
  constraints:
    min: 256
    max: 1024
  default: 512


# This for any internal plans prebuilt into the service broker that needs to be registered with CF
### ON_DEMAND_PLAN_BEGIN_MARKER
- name: on_demand_service_plans_collection
  type: collection
  configurable: true
  property_blueprints:
  - name: guid
    type: uuid
    optional: false
    unique: true
  - name: plan_name
    type: string
    configurable: true
  - name: plan_description
    type: string
    configurable: true
  - name: account_name
    type: string
    configurable: true
  - name: account_access_key
    type: string
    configurable: true
  - name: controller_host
    type: string
    configurable: true
  - name: controller_port
    type: integer
    configurable: true
  - name: ssl_enabled
    type: boolean
    configurable: true
    default: true
  - name: db_mon_enabled
    type: boolean
    configurable: true
    default: false
  - name: no_of_db_agents
    type: integer
    configurable: true
    default: 0
#  - name: db_agent_selector
#    type: selector
#    configurable: true
#    default: Disable
#    option_templates:
#      - name: db_agent_disabled_option
#        select_value: Disable
#        named_manifests:
#          - name: db_agent_snippet
#            manifest: |
#              db_agent_enabled: false
#              instances: 0
#      - name: db_agent_enabled_option
#        select_value: Enable
#        named_manifests:
#          - name: db_agent_snippet
#            manifest: |
#              db_agent_enabled: true
#              instances: (( .properties.on_demand_service_plans_collection.db_agent_selector.db_agent_enabled_option.instances.value ))
#        property_blueprints:
#          - name: instances
#            type: integer
#            configurable: true
#            default: 1
form_types:
- property_inputs:
  - reference: ".properties.app_name"
    label: Service Broker Application Name
    description: Enter the name for the Service Broker App
  - reference: ".properties.app_uri"
    label: Service Broker Application URI
    description: Enter the uri/endpoint for the Service Broker app (on push to CF)
  - reference: ".properties.enable_global_access_to_plans"
    label: Enable Access of Brokered Services and Plans to Everyone
    description: Open up All Services and plans to everyone across all orgs and spaces
  - reference: ".properties.on_demand_service_plans_collection"
    label: Service Plans
    property_inputs:
    - reference: plan_name
      label: Plan Name
      description: "Name of Plan"
      slug: false
    - reference: plan_description
      label: Plan Description
      description: "Description of Plan"
      slug: false
    - reference: account_name
      label: Account Name
      description: "Account Name"
      slug: false
    - reference: account_access_key
      label: Account Access Key
      description: "Account Access Key"
      slug: false
    - reference: controller_host
      label: AppDynamics Controller Host Address/IP
      description: "AppDynamics Controller FQDN Address/IP"
      slug: false
    - reference: controller_port
      label: AppDynamics Controller Port
      description: "AppDynamics Controller Port"
      slug: false
    - reference: ssl_enabled
      label: AppDynamics Controller SSL Enabled
      description: "Is AppDynamics Controller SSL Enabled"
      slug: false
    - reference: db_mon_enabled
      label: AppDynamics Database Monitoring Configuration
             Enable Database Monitoring
      description: "Enable AppDynamics DB Monitoring"
      slug: false
    - reference: no_of_db_agents
      label: Max number of DB instances to monitor
      description: "Max number of database instances to monitor"
      slug: false

  name: appdynamics_broker_app
  label: Service Broker Application
  description: Service Broker Configuration

- property_inputs:
  - reference: ".properties.machine_agent_app_name"
    label: Application Name
    description: Enter the app name for Machine Agent. This should be unique across PCF installations
  - reference: ".properties.machine_agent_app_uri"
    label: Application URI
    description: Enter the uri/endpoint for the Machine Agent app (on push to CF)
  - reference: .properties.account_name
    label: Account Name
    description: "Account Name"
  - reference: .properties.account_access_key
    label: Account Access Key
    description: "Account Access Key"
  - reference: .properties.controller_host
    label: AppDynamics Controller Host Address/IP
    description: "AppDynamics Controller Host Address/IP"
  - reference: .properties.controller_port
    label: AppDynamics Controller Port
    description: "AppDynamics Controller Port"
  - reference: .properties.ssl_enabled
    label: AppDynamics Controller SSL Enabled
    description: "Is AppDynamics Controller SSL Enabled"
  - reference: .properties.ops_metrics_host
    label: Ops Metrics Host Address
    description: "PCF Ops Metrics Host Address"
  - reference: .properties.ops_metrics_port
    label: Ops Metrics Host Port
    description: "PCF Ops Metrics Host Port"
  - reference: .properties.ops_metrics_authenticate
    label: Enable Ops Metrics JMX Authentication
    description: "PCF Ops Metrics JMX login with Authentication"
  - reference: .properties.ops_metrics_jmx_user
    label: Ops Metrics JMX User Id
    description: "PCF Ops Metrics JMX User Id"
  - reference: .properties.ops_metrics_jmx_password
    label: Ops Metrics JMX User Password
    description: "PCF Ops Metrics JMX User Password"
#  - reference: ".properties.proxy_enabled"
#    label: HTTP Web Proxy Enabled
#    description: All external communication to AppD SaaS services through a Web Proxy
#  - reference: ".properties.http_proxy_host"
#    label: Web Proxy Host Name/IP
#    description: Host Address of the web proxy(Only IP or FQDN)
#  - reference: ".properties.http_proxy_port"
#    label: Web Proxy Port
#    description: Port of the web proxy (to handle http and https port)
#  - reference: ".properties.proxy_auth_enabled"
#    label: HTTP Web Proxy Auth Enabled
#    description: All external communication to AppD SaaS services through a Web Proxy with user auth
#  - reference: ".properties.http_proxy_user"
#    label: Web Proxy Username
#    description: Username for the web proxy
#  - reference: ".properties.http_proxy_password"
#    label: Web Proxy Password
#    description: Password for the web proxy
  name: appdynamics_machine_agent_app
  label: Machine Agent Extension For PCF JMX Bridge
  description: Machine Agent Configuration
- property_inputs:
  - reference: .properties.proxy_selector
    label: 'Enable Web Proxy'
    selector_property_inputs:
    - reference: ".properties.proxy_selector.proxy_disabled_option"
      label: 'Disable'
    - reference: ".properties.proxy_selector.proxy_enabled_option"
      label: 'Enable'
      property_inputs:
      - reference: ".properties.proxy_selector.proxy_enabled_option.http_proxy_host"
        label: Web Proxy Host Name/IP
        description: Host Address of the web proxy(Only IP or FQDN)
      - reference: ".properties.proxy_selector.proxy_enabled_option.http_proxy_port"
        label: Web Proxy Port
        description: Port of the web proxy (to handle http and https port)
      - reference: ".properties.proxy_selector.proxy_enabled_option.proxy_auth_enabled"
        label: HTTP Web Proxy Auth Enabled
        description: All external communication to AppD SaaS services through a Web Proxy with user auth
      - reference: ".properties.proxy_selector.proxy_enabled_option.http_proxy_user"
        label: Web Proxy Username
        description: Username for the web proxy
      - reference: ".properties.proxy_selector.proxy_enabled_option.http_proxy_password"
        label: Web Proxy Password
        description: Password for the web proxy

  name: appdynamics_web_proxy
  label: Web Proxy Configuration
  description: Web Proxy Configuration

job_types:
- name: deploy-service-broker
  resource_label: Deploy AppDynamics Service Broker
  release: appdynamics_broker
  errand: true
  templates:
  - name: deploy-service-broker
    release: appdynamics_broker
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 512
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 2048
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap
  - name: broker_credentials
    type: salted_credentials

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_broker:
      app_name: (( .properties.app_name.value ))
      app_version: (( .properties.app_version.value ))
      app_uri: (( .properties.app_uri.value ))
      create_open_security_group: (( .properties.create_open_security_group.value ))
      app_push:
        org_quota: (( .properties.org_quota.value ))
        timeout: 180
        memory: (( .properties.memory.value ))
      persistence_store_type: none
      on_demand_service_plans: (( .properties.on_demand_service_plans_collection.value ))
      encryption_key: (( .properties.encryption_key.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-service-broker.broker_credentials.identity ))
        password: (( .deploy-service-broker.broker_credentials.password ))
        internal_service_names: (( .properties.internal_service_names.value ))

- name: deploy-machine-agent
  resource_label: Deploy AppDynamics Machine Agent
  release: appdynamics_broker
  errand: true
  templates:
  - name: deploy-machine-agent
    release: appdynamics_broker
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 1024
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 2048
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap
  - name: broker_credentials
    type: salted_credentials

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_machine_agent:
      app_name: (( .properties.machine_agent_app_name.value ))
      app_push:
        org_quota: 2048
        timeout: 180
        memory: 1024
      encryption_key: (( .properties.encryption_key.value ))
      create_open_security_group: (( .properties.create_open_security_group.value ))
      account_name: (( .properties.account_name.value ))
      account_access_key: (( .properties.account_access_key.value ))
      controller_host: (( .properties.controller_host.value ))
      controller_port: (( .properties.controller_port.value ))
      ssl_enabled: (( .properties.ssl_enabled.value ))
      tier_name: (( .properties.tier_name.value ))
      node_name: (( .properties.node_name.value ))
      web_proxy: (( .properties.proxy_selector.selected_option.parsed_manifest(proxy_snippet) ))
      ops_metrics_host: (( .properties.ops_metrics_host.value ))
      ops_metrics_port: (( .properties.ops_metrics_port.value ))
      ops_metrics_authenticate: (( .properties.ops_metrics_authenticate.value ))
      ops_metrics_jmx_user: (( .properties.ops_metrics_jmx_user.value ))
      ops_metrics_jmx_password: (( .properties.ops_metrics_jmx_password.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-machine-agent.broker_credentials.identity ))
        password: (( .deploy-machine-agent.broker_credentials.password ))

- name: deploy-db-agent
  resource_label: Deploy AppDynamics Database Agent
  release: appdynamics_broker
  errand: true
  templates:
  - name: deploy-db-agent
    release: appdynamics_broker
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 1024
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 2048
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap
  - name: broker_credentials
    type: salted_credentials

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_db_agent:
      app_name: (( .properties.db_agent_app_name.value ))
      app_push:
        org_quota: 2048
        timeout: 180
        memory: 1024
      encryption_key: (( .properties.encryption_key.value ))
      create_open_security_group: (( .properties.create_open_security_group.value ))
      account_name: (( .properties.account_name.value ))
      account_access_key: (( .properties.account_access_key.value ))
      controller_host: (( .properties.controller_host.value ))
      controller_port: (( .properties.controller_port.value ))
      ssl_enabled: (( .properties.ssl_enabled.value ))
      web_proxy: (( .properties.proxy_selector.selected_option.parsed_manifest(proxy_snippet) ))
      on_demand_service_plans: (( .properties.on_demand_service_plans_collection.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))

- name: register-broker
  resource_label: Register AppDynamics Service Broker
  templates:
  - name: register-broker
    release: appdynamics_broker
  errand: true
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 1024
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 2048
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_broker:
      app_name: (( .properties.app_name.value ))
      app_version: (( .properties.app_version.value ))
      app_uri: (( .properties.app_uri.value ))
      encryption_key: (( .properties.encryption_key.value ))
      enable_global_access_to_plans: (( .properties.enable_global_access_to_plans.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-service-broker.broker_credentials.identity ))
        password: (( .deploy-service-broker.broker_credentials.password ))
        internal_service_names: (( .properties.internal_service_names.value ))

- name: destroy-broker
  resource_label: Remove AppDynamics Service Broker
  templates:
  - name: destroy-broker
    release: appdynamics_broker
  errand: true
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 1024
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 1024
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_broker:
      app_name: (( .properties.app_name.value ))
      app_version: (( .properties.app_version.value ))
      app_uri: (( .properties.app_uri.value ))
      encryption_key: (( .properties.encryption_key.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-service-broker.broker_credentials.identity ))
        password: (( .deploy-service-broker.broker_credentials.password ))
        internal_service_names: (( .properties.internal_service_names.value ))

- name: destroy-machine-agent
  resource_label: Remove AppDynamics Machine Agent
  templates:
  - name: destroy-machine-agent
    release: appdynamics_broker
  errand: true
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 1024
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 1024
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_machine_agent:
      app_name: (( .properties.machine_agent_app_name.value ))
      app_version: (( .properties.machine_agent_app_version.value ))
      app_uri: (( .properties.machine_agent_app_uri.value ))
      encryption_key: (( .properties.encryption_key.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-machine-agent.broker_credentials.identity ))
        password: (( .deploy-machine-agent.broker_credentials.password ))

- name: destroy-db-agent
  resource_label: Remove AppDynamics DB Agent
  templates:
  - name: destroy-db-agent
    release: appdynamics_broker
  errand: true
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 1024
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 1024
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        appdynamics_broker:
          secret: test
    appdynamics_db_agent:
      app_name: (( .properties.db_agent_app_name.value ))
      app_version: (( .properties.db_agent_app_version.value ))
      app_uri: (( .properties.db_agent_app_uri.value ))
      encryption_key: (( .properties.encryption_key.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-db-agent.broker_credentials.identity ))
        password: (( .deploy-db-agent.broker_credentials.password ))

- name: compilation
  resource_label: compilation
  resource_definitions:
   - name: ram
     type: integer
     configurable: true
     default: 1024
   - name: ephemeral_disk
     type: integer
     configurable: true
     default: 1024
   - name: persistent_disk
     type: integer
     configurable: true
     default: 0
   - name: cpu
     type: integer
     configurable: true
     default: 2

  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1

  instance_definitions:
    - name: instances
      type: integer
      default: 1

update:
  canaries: 1
  canary_watch_time: 60000-240000
  max_in_flight: 1
  update_watch_time: 60000-240000

requires_product_versions:
- name: cf
  version: "~> 1.3"
provides_product_versions:
- name: appdynamics_broker
  version: '4.1.5.3'
post_deploy_errands:
- name: deploy-service-broker
- name: deploy-machine-agent
- name: register-broker
- name: deploy-db-agent
pre_delete_errands:
- name: destroy-broker
- name: destroy-machine-agent
- name: destroy-db-agent
